import fs from "fs"
import { smogonSpeedData } from "./smogon-speed-data.js"

createSpeedStatisticsFile("2025-01", "g")

export async function createSpeedStatisticsFile(date, reg) {
  const speedStatistics = await smogonSpeedData(date, reg)

  let fileContent = ""

  speedStatistics.forEach(s => {
    fileContent += `  "${Object.keys(s)[0]}": ${JSON.stringify(Object.values(s)[0])},\n`
  })

  fs.writeFileSync("src/data/speed-statistics.ts", createClassContent(fileContent))
}

function createClassContent(speedStatistics) {
  return `// This class is generated by speed-statistics-class-generator.js script
  
  type SpeedStatistic = {
  speed: number
  percentile: number
  percentage: number
  speedEv: number
  nature: string
  }  

  export const SPEED_STATISTICS: Record<string, SpeedStatistic[]> = {
    ${speedStatistics}
  }
  `
}
