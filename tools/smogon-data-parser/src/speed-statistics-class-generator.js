import fs from "fs"
import { smogonSpeedData } from "./smogon-speed-data.js"

export async function createSpeedStatisticsFile(date, regulation) {
  const speedStatistics = await smogonSpeedData(date, regulation)

  let fileContent = ""

  speedStatistics.forEach(s => {
    fileContent += `  "${Object.keys(s)[0]}": ${JSON.stringify(Object.values(s)[0])},\n`
  })

  fs.writeFileSync(`src/data/speed-statistics-reg-${regulation}.ts`, createClassContent(fileContent, regulation))
}

function createClassContent(speedStatistics, regulation) {
  return `// This class is generated by speed-statistics-class-generator.js script

  import { SpeedData } from "./speed-data";

  export const SPEED_STATISTICS_REG_${regulation.toUpperCase()}: Record<string, SpeedData> = {
    ${speedStatistics}
  }
  `
}
